{"version":3,"sources":["../../../src/gateway/middleware/log-request-info-middleware.js"],"names":["logRequestInfoMiddleware","req","res","next","logger","info","url","method","debug","headers"],"mappings":";;;;;;;AAEA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,wBAAT,CACHC,GADG,EAEHC,GAFG,EAGHC,IAHG,EAIC;AACJ,QAAMC,MAAM,GAAG,sBAAUH,GAAV,CAAf;AACAG,EAAAA,MAAM,CAACC,IAAP,CAAa,qBAAoBJ,GAAG,CAACK,GAAI,EAAzC,EAA4C;AACxCC,IAAAA,MAAM,EAAEN,GAAG,CAACM,MAD4B;AAExCD,IAAAA,GAAG,EAAEL,GAAG,CAACK;AAF+B,GAA5C;AAIAF,EAAAA,MAAM,CAACI,KAAP,CAAc,qBAAoBP,GAAG,CAACK,GAAI,EAA1C,EAA6C;AACzCG,IAAAA,OAAO,EAAER,GAAG,CAACQ,OAD4B;AAEzCF,IAAAA,MAAM,EAAEN,GAAG,CAACM,MAF6B;AAGzCD,IAAAA,GAAG,EAAEL,GAAG,CAACK;AAHgC,GAA7C;AAMAH,EAAAA,IAAI;AACP","sourcesContent":["// @flow\nimport type {$Response, NextFunction} from \"express\";\nimport {getLogger} from \"../../shared/index.js\";\n\nimport type {Request} from \"../types.js\";\n\n/**\n * Simple middleware that logs some info about the incoming request.\n *\n * We log both at the info and debug levels. The info log line doesn't\n * include the headers since they give us problems with exporting our\n * info logs to bigquery. The issue is that we end up with a bigquery\n * column per unique header name, and so we run out of columns.\n */\nexport function logRequestInfoMiddleware<Req: Request, Res: $Response>(\n    req: Req,\n    res: Res,\n    next: NextFunction,\n): void {\n    const logger = getLogger(req);\n    logger.info(`Request received: ${req.url}`, {\n        method: req.method,\n        url: req.url,\n    });\n    logger.debug(`Request received: ${req.url}`, {\n        headers: req.headers,\n        method: req.method,\n        url: req.url,\n    });\n\n    next();\n}\n"],"file":"log-request-info-middleware.js"}